# OSMO UI Development Rules

## Architecture

### Layer Pattern (Top to Bottom)
```
Page → Headless Hook → Adapter Hook → Generated API
            ↓
     Themed Components
```

- **Pages** (`src/app/`): Compose hooks + components, minimal logic
- **Headless hooks** (`src/headless/`): Business logic, filtering, state - NO UI
- **Adapter hooks** (`src/lib/api/adapter/`): Clean types, transform backend quirks
- **Generated API** (`src/lib/api/generated.ts`): Auto-generated, don't edit
- **Themed components** (`src/components/features/`): Presentation only

### Component Organization
- `src/components/ui/` - shadcn/ui primitives (Button, Input, Dialog)
- `src/components/shell/` - Layout (Header, Sidebar)
- `src/components/features/` - Feature-specific themed components
- `src/headless/` - Business logic hooks (no UI)

## API Usage

**DO:**
```typescript
import { usePools, usePoolResources } from "@/lib/api/adapter";
```

**DON'T:**
```typescript
import { useGetPoolQuotasApiPoolQuotaGet } from "@/lib/api/generated";
```

- Always use adapter hooks - they provide clean types
- Backend quirks are isolated in `src/lib/api/adapter/`
- See `adapter/backend_todo.md` for known issues

## Tech Stack
- Next.js 16+ (App Router, Turbopack)
- React 19, TypeScript strict
- Tailwind CSS 4 with CSS variables
- shadcn/ui + Radix for components
- TanStack Query 5 for server state
- orval for API codegen

## Styling

- Use Tailwind classes only (no CSS modules)
- Shared patterns in `src/lib/styles.ts`
- CSS variables in `globals.css` for theming
- Mobile-first responsive design

## Constants

Organize magic strings/numbers in `src/lib/constants/`:
- `roles.ts` - User roles and role checking
- `storage.ts` - localStorage/cookie keys
- `headers.ts` - Custom HTTP headers
- `ui.ts` - Display configs (status colors, labels)

## Patterns

- React Server Components by default
- `'use client'` only when needed (interactivity, hooks)
- Composition over inheritance
- All components must be accessible (ARIA)
- Props down, events up - no prop drilling through context

## Adding Features

1. Create page in `src/app/(dashboard)/feature/page.tsx`
2. Create headless hook in `src/headless/use-feature.ts`
3. Create themed components in `src/components/features/feature/`
4. Export from index.ts files
5. Use adapter hooks for API data

## Auth

- Auth logic in `src/lib/auth/`
- Use `useAuth()` for auth state
- Use `useUser()` for user info
- Token refresh is automatic and lazy
